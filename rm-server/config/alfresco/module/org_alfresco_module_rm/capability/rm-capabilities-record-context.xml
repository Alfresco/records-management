<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE beans PUBLIC '-//SPRING//DTD BEAN//EN' 'http://www.springframework.org/dtd/spring-beans.dtd'>

<beans>

   <bean id="rmViewRecordsCapability"
      parent="rmBaseCapability"
      class="org.alfresco.module.org_alfresco_module_rm.capability.impl.ViewRecordsCapability">
      <property name="name" value="ViewRecords" />
      <property name="group"><ref bean="recordsGroup"/></property>
      <property name="index" value="30" />
   </bean>

   <bean id="rmUndeclareRecordsCapability"
      parent="declarativeCapability">
      <property name="name" value="UndeclareRecords"/>
      <property name="permission" value="UndeclareRecords"/>
      <property name="kinds">
         <list>
            <value>RECORD</value>
         </list>
      </property>
      <property name="conditions">
         <map>
            <entry key="capabilityCondition.filling" value="true"/>
            <entry key="capabilityCondition.frozen" value="false"/>
            <entry key="capabilityCondition.declared" value="true"/>
            <entry key="capabilityCondition.cutoff" value="false"/>
         </map>
      </property>
      <property name="group"><ref bean="recordsGroup"/></property>
      <property name="index" value="20" />
   </bean>

   <bean id="rmCreateModifyRecordsInCuttoffFoldersCapability"
      parent="declarativeCapability">
      <property name="name" value="CreateModifyRecordsInCutoffFolders"/>
      <property name="permission" value="CreateModifyRecordsInCutoffFolders"/>
      <property name="kinds">
         <list>
            <value>RECORD_FOLDER</value>
            <value>RECORD</value>
         </list>
      </property>
      <property name="conditions">
         <map>
            <entry key="capabilityCondition.filling" value="true"/>
            <entry key="capabilityCondition.cutoff" value="true"/>
            <entry key="capabilityCondition.frozen" value="false"/>
            <entry key="capabilityCondition.closed" value="false"/>
         </map>
      </property>
      <property name="group"><ref bean="cutoffGroup"/></property>
      <property name="index" value="20" />
   </bean>

   <bean id="rmFileCapability"
      parent="declarativeCapability">
      <property name="name" value="File"/>
      <property name="private" value="true"/>
      <property name="conditions">
         <map>
            <entry key="capabilityCondition.filling" value="true"/>
            <entry key="capabilityCondition.frozen" value="false"/>
            <entry key="capabilityCondition.cutoff" value="false"/>
            <entry key="capabilityCondition.closed" value="false"/>
            <entry key="capabilityCondition.declared" value="false"/>
         </map>
      </property>
   </bean>

   <bean id="rmFileRecordsCapability"
      parent="compositeCapability">
      <property name="name" value="FileRecords" />
      <property name="capabilities">
         <list>
            <ref bean="rmFileCapability"/>
            <ref bean="rmCreateModifyRecordsInCuttoffFoldersCapability"/>
         </list>
      </property>
   </bean>

   <bean id="rmLinkToRecordsCapability"
      parent="declarativeCapability">
      <property name="name" value="LinkToRecords"/>
      <property name="private" value="true" />
      <property name="conditions">
         <map>
            <entry key="capabilityCondition.frozen" value="false"/>
            <entry key="capabilityCondition.recordFiled" value="true"/>	  <!--  Can only link a filed record -->
         </map>
      </property>
      <property name="targetCapability" ref="rmFileRecordsCapability" />
   </bean>

   <bean id="rmFileToRecordsCapability"
      parent="declarativeCapability">
      <property name="name" value="FileToRecords"/>
      <property name="private" value="true" />								<!-- This is an unasingable capability, we reference an assignable one in the target -->
      <property name="conditions">
         <map>
            <entry key="capabilityCondition.filling" value="true"/>  		<!--  Checks if the user has the filling capability -->
            <entry key="capabilityCondition.frozen" value="false"/>  		<!--  Checks that the node is not frozen -->
            <entry key="capabilityCondition.recordFiled" value="false"/>	<!--  Checks that the node hasn't been filed -->
         </map>
      </property>
      <property name="targetCapability" ref="rmFileRecordsCapability" />  <!--  Checks that the user has the correct capability on the destination folder -->
   </bean>

   <bean id="rmDeclareRecordsCapability"
      parent="declarativeCapability">
      <property name="name" value="DeclareRecords"/>
      <property name="permission" value="DeclareRecords"/>
      <property name="kinds">
         <list>
            <value>RECORD</value>
         </list>
      </property>
      <property name="conditions">
         <map>
            <entry key="capabilityCondition.filling" value="true"/>
            <entry key="capabilityCondition.cutoff" value="false"/>
            <entry key="capabilityCondition.frozen" value="false"/>
            <entry key="capabilityCondition.declared" value="false"/>
         </map>
      </property>
      <property name="group"><ref bean="recordsGroup"/></property>
      <property name="index" value="10" />
   </bean>

   <bean id="rmDeleteRecordsCapability"
      parent="declarativeCapability">
      <property name="name" value="DeleteRecords"/>
      <property name="permission" value="DeleteRecords"/>
      <property name="kinds">
         <list>
            <value>RECORD</value>
         </list>
      </property>
      <property name="conditions">
         <map>
            <entry key="capabilityCondition.frozen" value="false"/>
         </map>
      </property>
      <property name="group"><ref bean="dispositionAndTransfersGroup"/></property>
      <property name="index" value="30" />
   </bean>

   <bean id="rmEditDeclaredRecordMetadataCapability"
      parent="declarativeCapability">
      <property name="name" value="EditDeclaredRecordMetadata"/>
      <property name="permission" value="EditDeclaredRecordMetadata"/>
      <property name="kinds">
         <list>
            <value>RECORD</value>
         </list>
      </property>
      <property name="conditions">
         <map>
            <entry key="capabilityCondition.filling" value="true"/>
            <entry key="capabilityCondition.cutoff" value="false"/>
            <entry key="capabilityCondition.frozen" value="false"/>
            <entry key="capabilityCondition.declared" value="true"/>
         </map>
      </property>
      <property name="group"><ref bean="metadataControlGroup"/></property>
      <property name="index" value="10" />
   </bean>

   <!-- TODO .. this is being used for the wrong thing! ... should indicate that the use can edit the non-record meta-data of a record -->
   <!-- TODO .. may need some kind of 'prep' record capability you get with file? .. I think this is what this is being used for atm -->
   <bean id="rmEditNonRecordMetadataCapability"
      parent="declarativeCapability"
      class="org.alfresco.module.org_alfresco_module_rm.capability.impl.EditCapability">
      <property name="name" value="EditNonRecordMetadata"/>
      <property name="permission" value="EditNonRecordMetadata"/>
      <property name="conditions">
         <map>
            <entry key="capabilityCondition.fileable" value="true"/>
            <entry key="capabilityCondition.frozen" value="false"/>
         </map>
      </property>
      <property name="group"><ref bean="metadataControlGroup"/></property>
      <property name="index" value="20" />
   </bean>

   <bean id="rmEditRecordMetadataCapability"
      parent="rmBaseCapability"
      class="org.alfresco.module.org_alfresco_module_rm.capability.impl.EditCapability">
      <property name="name" value="EditRecordMetadata"/>
      <property name="permission" value="EditRecordMetadata"/>
      <property name="kinds">
         <list>
            <value>RECORD</value>
         </list>
      </property>
      <property name="conditions">
         <map>
            <entry key="capabilityCondition.filling" value="true"/>
            <entry key="capabilityCondition.cutoff" value="false"/>
            <entry key="capabilityCondition.frozen" value="false"/>
            <entry key="capabilityCondition.closed" value="false"/>
            <entry key="capabilityCondition.declared" value="false"/>
         </map>
      </property>
      <property name="group"><ref bean="metadataControlGroup"/></property>
      <property name="index" value="30" />
   </bean>

   <bean id="rmMoveRecordsCapability"
      parent="declarativeCapability" >
      <property name="name" value="MoveRecords" />
      <property name="permission" value="MoveRecords"/>
      <property name="undetermined" value="true" />
      <property name="kind" value="RECORD" />
      <property name="conditions">
         <map>
            <entry key="capabilityCondition.frozen" value="false"/>			
            <entry key="capabilityCondition.recordFiled" value="true"/>		<!--  Can only move a filed record -->
            <entry key="capabilityCondition.cutoff" value="false"/>          <!-- Can not move a record once it is cutoff -->	
         </map>
      </property>
      <property name="targetCapability" ref="rmFileRecordsCapability"/>
      <property name="group"><ref bean="metadataControlGroup"/></property>
      <property name="index" value="40" />
   </bean>

   <bean id="rmUpgradeDowngradeAndDeclassifyRecordsCapability"
      parent="declarativeCapability">
      <property name="name" value="UpgradeDowngradeAndDeclassifyRecords"/>
      <property name="permission" value="UpgradeDowngradeAndDeclassifyRecords"/>
      <property name="conditions">
         <map>
            <entry key="capabilityCondition.frozen" value="false"/>
         </map>
      </property>
      <property name="group"><ref bean="classifiedRecordsGroup"/></property>
      <property name="index" value="60" />
   </bean>

</beans>